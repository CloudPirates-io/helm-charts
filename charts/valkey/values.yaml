## @section Global parameters
global:
  ## @param global.imageRegistry Global Docker Image registry
  imageRegistry: ""
  ## @param global.imagePullSecrets Global Docker registry secret names as an array
  imagePullSecrets: []

## @param clusterDomain Kubernetes cluster domain
clusterDomain: cluster.local

## @section Common parameters
## @param nameOverride String to partially override valkey.fullname
nameOverride: ""
## @param fullnameOverride String to fully override valkey.fullname
fullnameOverride: ""
## @param commonLabels Labels to add to all deployed objects
commonLabels: {}
## @param commonAnnotations Annotations to add to all deployed objects
commonAnnotations: {}

## @section Valkey image configuration
image:
  ## @param image.registry Valkey image registry
  registry: docker.io
  ## @param image.repository Valkey image repository
  repository: valkey/valkey
  ## @param image.tag Valkey image tag (immutable tags are recommended)
  tag: "9.0.0-alpine3.22@sha256:b4ee67d73e00393e712accc72cfd7003b87d0fcd63f0eba798b23251bfc9c394"
  ## @param image.imagePullPolicy Valkey image pull policy
  imagePullPolicy: Always

## @section Valkey Architecture
## @param architecture Valkey architecture. Allowed values: standalone, replication
## - standalone: Single Valkey instance
## - replication: Master-replica setup (use sentinel.enabled to enable/disable Sentinel)
architecture: standalone

## @param replicaCount Number of Valkey instances to deploy (only when architecture=replication)
## When using architecture=replication:
##   with Sentinel, this is the total number of Valkey instances (including the initial master)
##   without Sentinel, pod-0 is always the master and other pods are replicas
##   For example: replicaCount: 3 creates 1 master + 2 replicas
replicaCount: 3

## @param ipFamily IP family to use for replica and sentinel announce IPs. Allowed values: auto, ipv4, ipv6
## auto: Uses the first IP returned by hostname -i (default)
## ipv4: Forces IPv4 address selection
## ipv6: Forces IPv6 address selection
ipFamily: auto

## @section Pod annotations and labels
## @param podAnnotations Map of annotations to add to the pods
podAnnotations: {}
## @param podLabels Map of labels to add to the pods
podLabels: {}

## @section Security Context
podSecurityContext:
  ## @param podSecurityContext.fsGroup Group ID for the volumes of the pod
  fsGroup: 1000

containerSecurityContext:
  ## @param containerSecurityContext.allowPrivilegeEscalation Enable container privilege escalation
  allowPrivilegeEscalation: false
  ## @param containerSecurityContext.runAsNonRoot Configure the container to run as a non-root user
  runAsNonRoot: true
  ## @param containerSecurityContext.runAsUser User ID for the Valkey container
  runAsUser: 999
  ## @param containerSecurityContext.runAsGroup Group ID for the Valkey container
  runAsGroup: 1000
  ## @param containerSecurityContext.readOnlyRootFilesystem Mount container root filesystem as read-only
  readOnlyRootFilesystem: true
  ## @param containerSecurityContext.capabilities.drop Linux capabilities to be dropped
  capabilities:
    drop:
      - ALL

## @section Valkey Authentication
auth:
  ## @param auth.enabled Enable password authentication
  enabled: true
  ## @param auth.password Valkey password
  password: ""
  ## @param auth.existingSecret The name of an existing secret with Valkey credentials
  existingSecret: ""
  ## @param auth.existingSecretPasswordKey Password key to be retrieved from existing secret
  existingSecretPasswordKey: "password"

## @section Valkey Configuration
config:
  ## @param config.maxMemory Maximum memory usage for Valkey (e.g., 256mb, 1gb)
  maxMemory: ""
  ## @param config.maxMemoryPolicy Memory eviction policy when maxmemory is reached
  maxMemoryPolicy: "allkeys-lru"
  ## @param config.save Valkey save configuration (e.g., "900 1 300 10 60 10000")
  save: "900 1 300 10 60 10000"
  ## @param config.extraConfig Additional Valkey configuration parameters
  extraConfig: []
  ## @param config.existingConfigmap Name of existing ConfigMap with Valkey configuration
  existingConfigmap: ""

## @section Service configuration
service:
  ## @param service.type Valkey service type
  type: ClusterIP
  ## @param service.port Valkey service port
  port: 6379
  ## @param service.targetPort Valkey container port
  targetPort: 6379
  ## @param service.annotations Service annotations
  annotations: {}

## @section Service Account configuration
## @param serviceAccount.create Enable creation of a Service Account
serviceAccount:
  create: false
  ## @param serviceAccount.name Name of the Service Account
  name: ""
  ## @param serviceAccount.annotations Annotations to add to the Service Account
  annotations: {}
  ## @param serviceAccount.automountToken Enable automounting of the Service Account token
  automountToken: false

## @section Ingress configuration
ingress:
  ## @param ingress.enabled Enable ingress record generation for Valkey
  enabled: false
  ## @param ingress.className IngressClass that will be used to implement the Ingress
  className: ""
  ## @param ingress.annotations Additional annotations for the Ingress resource
  annotations:
    {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  ## @param ingress.hosts[0].host Hostname for Valkey ingress
  ## @param ingress.hosts[0].paths[0].path Path for Valkey ingress
  ## @param ingress.hosts[0].paths[0].pathType Path type for Valkey ingress
  hosts:
    - host: valkey.local
      paths:
        - path: /
          pathType: Prefix
  ## @param ingress.tls TLS configuration for Valkey ingress
  tls: []
  #  - secretName: valkey-tls
  #    hosts:
  #      - valkey.local

## @section Resources
resources:
  limits:
    memory: 64Mi
  requests:
    cpu: 10m
    memory: 64Mi

## @section Persistence
persistence:
  ## @param persistence.enabled Enable persistence using Persistent Volume Claims
  enabled: true
  ## @param persistence.storageClass Persistent Volume storage class
  storageClass: ""
  ## @param persistence.annotations Persistent Volume Claim annotations
  annotations: {}
  ## @param persistence.size Persistent Volume size
  size: 8Gi
  ## @param persistence.accessModes Persistent Volume access modes
  accessModes:
    - ReadWriteOnce

## @section Liveness and readiness probes
livenessProbe:
  ## @param livenessProbe.enabled Enable livenessProbe on Valkey containers
  enabled: true
  ## @param livenessProbe.initialDelaySeconds Initial delay seconds for livenessProbe
  initialDelaySeconds: 20
  ## @param livenessProbe.periodSeconds Period seconds for livenessProbe
  periodSeconds: 10
  ## @param livenessProbe.timeoutSeconds Timeout seconds for livenessProbe
  timeoutSeconds: 5
  ## @param livenessProbe.failureThreshold Failure threshold for livenessProbe
  failureThreshold: 3
  ## @param livenessProbe.successThreshold Success threshold for livenessProbe
  successThreshold: 1

readinessProbe:
  ## @param readinessProbe.enabled Enable readinessProbe on Valkey containers
  enabled: true
  ## @param readinessProbe.initialDelaySeconds Initial delay seconds for readinessProbe
  initialDelaySeconds: 5
  ## @param readinessProbe.periodSeconds Period seconds for readinessProbe
  periodSeconds: 5
  ## @param readinessProbe.timeoutSeconds Timeout seconds for readinessProbe
  timeoutSeconds: 1
  ## @param readinessProbe.failureThreshold Failure threshold for readinessProbe
  failureThreshold: 3
  ## @param readinessProbe.successThreshold Success threshold for readinessProbe
  successThreshold: 1

startupProbe:
  ## @param startupProbe.enabled Enable startupProbe on Valkey containers
  enabled: false
  ## @param startupProbe.initialDelaySeconds Initial delay seconds for startupProbe
  initialDelaySeconds: 20
  ## @param startupProbe.periodSeconds Period seconds for startupProbe
  periodSeconds: 5
  ## @param startupProbe.timeoutSeconds Timeout seconds for startupProbe
  timeoutSeconds: 1
  ## @param startupProbe.failureThreshold Failure threshold for startupProbe
  failureThreshold: 30
  ## @param startupProbe.successThreshold Success threshold for startupProbe
  successThreshold: 1

## @section Node Selection
## @param nodeSelector Node labels for pod assignment
nodeSelector: {}

## @param tolerations Toleration labels for pod assignment
tolerations: []

## @param affinity Affinity settings for pod assignment
affinity: {}

## @param extraEnvVars Additional environment variables to set
extraEnvVars: []
  # - name: CUSTOM_VAR
  #   value: "custom-value"
  # - name: SECRET_VAR
  #   valueFrom:
  #     secretKeyRef:
  #       name: my-secret
  #       key: secret-key

## @param extraObjects Array of extra objects to deploy with the release
extraObjects: []
# - apiVersion: v1
#   kind: ConfigMap
#   metadata:
#     name: extra-config
#     namespace: "{{ .Release.Namespace }}"
#   data:
#     key: value

## @section Metrics configuration
metrics:
  ## @param metrics.enabled Start a sidecar prometheus exporter to expose Valkey metrics
  enabled: false
  image:
    ## @param metrics.image.registry Valkey exporter image registry
    registry: docker.io
    ## @param metrics.image.repository Valkey exporter image repository
    repository: oliver006/redis_exporter
    ## @param metrics.image.tag Valkey exporter image tag
    tag: "v1.79.0-alpine@sha256:15a93b250a16537445e0c1bff2c1c0097c829aea79f18ae194ecd2687ae0de07"
    ## @param metrics.image.pullPolicy Valkey exporter image pull policy
    pullPolicy: Always
  ## @param metrics.resources Resource limits and requests for metrics container
  resources: {}
  ## Metrics service configuration
  service:
    ## @param metrics.service.annotations Additional custom annotations for Metrics service
    annotations: {}
    ## @param metrics.service.labels Additional custom labels for Metrics service
    labels: {}
    ## @param metrics.service.port Metrics service port
    port: 9121
  ## Prometheus Operator ServiceMonitor configuration
  serviceMonitor:
    ## @param metrics.serviceMonitor.enabled Create ServiceMonitor resource(s) for scraping metrics using PrometheusOperator
    enabled: false
    ## @param metrics.serviceMonitor.namespace The namespace in which the ServiceMonitor will be created
    namespace: ""
    ## @param metrics.serviceMonitor.interval The interval at which metrics should be scraped
    interval: 30s
    ## @param metrics.serviceMonitor.scrapeTimeout The timeout after which the scrape is ended
    scrapeTimeout: 10s
    ## @param metrics.serviceMonitor.selector Additional labels for ServiceMonitor resource
    selector: {}
    ## @param metrics.serviceMonitor.annotations ServiceMonitor annotations
    annotations: {}
    ## @param metrics.serviceMonitor.honorLabels honorLabels chooses the metric's labels on collisions with target labels
    honorLabels: false
    ## @param metrics.serviceMonitor.relabelings ServiceMonitor relabel configs to apply to samples before scraping
    relabelings: []
    ## @param metrics.serviceMonitor.metricRelabelings ServiceMonitor metricRelabelings configs to apply to samples before ingestion
    metricRelabelings: []
    ## @param metrics.serviceMonitor.namespaceSelector ServiceMonitor namespace selector
    namespaceSelector: {}

## @section Valkey Sentinel configuration
## This section configures Valkey Sentinel for high availability in replication mode
## When enabled, Valkey instances use dynamic master/replica role assignment managed by Sentinel
## When disabled with replication architecture, pod-0 is always the master and other pods are replicas
sentinel:
  ## @param sentinel.enabled Enable Valkey Sentinel for high availability
  ## IMPORTANT: When enabled, applications should use Sentinel-aware clients to discover the current master
  ## When disabled, pod-0 is the master and can be accessed via the -master service
  enabled: false
  image:
    ## @param sentinel.image.repository Valkey Sentinel image repository
    repository: valkey/valkey
    ## @param sentinel.image.tag Valkey Sentinel image tag
    tag: "9.0.0-alpine3.22@sha256:b4ee67d73e00393e712accc72cfd7003b87d0fcd63f0eba798b23251bfc9c394"
    ## @param sentinel.image.pullPolicy Valkey Sentinel image pull policy
    pullPolicy: Always
  ## @param sentinel.masterName Name of the master server (default: mymaster)
  masterName: mymaster
  ## @param sentinel.quorum Number of Sentinels that need to agree about the fact the master is not reachable
  quorum: 2
  ## @param sentinel.downAfterMilliseconds Time in milliseconds after the master is declared down
  downAfterMilliseconds: 1500
  ## @param sentinel.failoverTimeout Timeout for failover in milliseconds
  failoverTimeout: 15000
  ## @param sentinel.parallelSyncs Number of replicas that can be reconfigured to use the new master during a failover
  parallelSyncs: 1
  ## @param sentinel.port Sentinel port
  port: 26379
  ## @param sentinel.extraVolumeMounts Additional volume mounts to add to the Sentinel container
  extraVolumeMounts: []
  service:
    ## @param sentinel.service.type Kubernetes service type for Sentinel
    type: ClusterIP
    ## @param sentinel.service.port Sentinel service port
    port: 26379
  ## @param sentinel.resources Resource limits and requests for Sentinel pods
  resources:
    limits:
      memory: 128Mi
    requests:
      cpu: 25m
      memory: 64Mi

## @param resources Resource limits and requests for Valkey init container pod
initContainer:
  resources:
    limits:
      cpu: 50m
      memory: 128Mi
    requests:
      cpu: 25m
      memory: 64Mi
